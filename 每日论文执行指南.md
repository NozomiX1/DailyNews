# 每日论文精读执行指南

## 任务概述

本指南用于完成每日论文的**爬取、分析、发布**全流程。每篇论文会生成独立的精读分析，并发布为独立的微信公众号草稿。

**核心特点**：
- 每篇论文 = 独立的草稿
- 默认爬取**前一天**的论文
- 支持 Gemini AI 深度分析

---

## 步骤 1: 爬取论文榜单

获取 HuggingFace Daily Papers 并进行评分排序。

```bash
# 默认爬取昨天的论文
python -m src.paper_fetch

# 指定日期
python -m src.paper_fetch --date 2026-01-30

# 最多保存 30 篇
python -m src.paper_fetch --max-papers 30
```

**输出文件**: `data/papers/YYYY-MM-DD.md`

---

## 步骤 2: 下载并分析论文

根据榜单下载 PDF，使用 Gemini 生成精读分析。

```bash
# 默认分析昨天的论文
python -m src.paper_pipeline

# 指定日期
python -m src.paper_pipeline --date 2026-01-30

# 只下载和分析 5 篇
python -m src.paper_pipeline --min-papers 3 --max-papers 5

# 启用兴趣加成（给 LLM/Agent 等关键词加分）
python -m src.paper_pipeline --topic-bonus

# 预演模式（不实际下载）
python -m src.paper_pipeline --dry-run
```

**输出目录**: `output/YYYY-MM-DD/`
- `2601.21571_xxx_analysis.md` - 单篇论文分析
- `_summary.md` - 汇总报告

---

## 步骤 3: 发布到草稿箱

将分析结果发布为微信公众号草稿，**每篇论文一个独立草稿**。

```bash
# 默认发布昨天的所有论文
python -m src.paper_publisher

# 指定日期
python -m src.paper_publisher --date 2026-01-30

# 发布单个文件
python -m src.paper_publisher --file output/2026-01-30/2601.21571_xxx_analysis.md
```

**输出**: 多个微信草稿（登录公众号后台查看）

---

## 完整工作流示例

```bash
# 1. 获取昨天 (2026-01-30) 的论文榜单
python -m src.paper_fetch

# 2. 下载 PDF 并生成分析
python -m src.paper_pipeline

# 3. 发布所有论文到草稿箱
python -m src.paper_publisher

# 或者只发布某篇论文
python -m src.paper_publisher --file output/2026-01-30/2601.21571_xxx_analysis.md
```

---

## 注意事项

### 日期逻辑
- 默认使用**昨天**的日期（因为今天的论文还没出来）
- 可以通过 `--date` 参数指定任意日期

### API 限制
- ArXiv 有下载速率限制，每次下载间隔 3 秒
- Gemini API 通过 Antigravity 代理访问

### 评分规则
- **Super Lab** (+50): OpenAI, Anthropic, DeepMind, DeepSeek 等
- **Frontier Lab** (+20): Google, Meta, NVIDIA, Microsoft 等
- **爆款直通**: Stars > 2000 或 Upvotes > 500

### 下载策略
- 默认下载第 1 篇到最后一篇 Frontier Lab 论文
- 至少 3 篇，最多 20 篇（可配置）

---

## 文件路径速查

| 功能 | 路径 |
|------|------|
| 论文榜单 | `data/papers/YYYY-MM-DD.md` |
| PDF 下载 | `HF_Paper_Downloads/YYYY-MM-DD/*.pdf` |
| 分析输出 | `output/YYYY-MM-DD/*_analysis.md` |
| 汇总报告 | `output/YYYY-MM-DD/_summary.md` |
| 提示词模板 | `prompt.md` |

---

## 命令速查

```bash
# 快速执行昨天流程
python -m src.paper_fetch && python -m src.paper_pipeline && python -m src.paper_publisher

# 单独分析一个 PDF
python -m src.paper_analyze path/to/paper.pdf -o output.md

# 查看论文排名（不下载）
python -m src.paper_ranker --date 2026-01-30
```

---

## 模块说明

| 模块 | 功能 |
|------|------|
| `src/paper_fetch.py` | 获取 HF 论文榜单并排序 |
| `src/paper_ranker.py` | 论文评分系统 |
| `src/paper_pipeline.py` | 下载 + 分析完整流程 |
| `src/paper_analyze.py` | 单个 PDF 分析工具 |
| `src/paper_publisher.py` | 发布到微信草稿箱 |
| `src/gemini_client.py` | Gemini API 客户端 |
